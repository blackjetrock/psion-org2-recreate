//----------------------------------------------------------------------
//EASTRISING TECHNOLOGY CO,.LTD.//
// Module    : ER-OLED022-1  2.2" (LIGHT BLUE) 128*32 DOTS 
// Lanuage   : C51 Code
// Create    : JAVEN
// Date      : Mar-14-2014
// Drive IC  : ssd1305
// INTERFACE : I2C
// MCU 		 : AT89LV52
// VDD		 : 3.0    
//
//----------------------------------------------------------------------
#include <stdio.h>
#include "pico/stdlib.h"
#include "hardware/gpio.h"
#include "pico/binary_info.h"

#define IGNORE_ACK       0
#define DEMO_DELAY       1000

extern const uint PIN_LATCHOUT1;
void printxy(int x, int y, char ch);

////////////////////////////////////////////////////////////////////////////////
// Prototypes
//
void write_595(const uint latchpin, int value);

////////////////////////////////////////////////////////////////////////////////

#define uint unsigned int
#define uchar unsigned char

extern const uint PIN_I2C_SDA;
extern const uint PIN_I2C_SCL;

//#define SDA                  P1_1
//#define SCL                  P1_0
//#define RST                  P3_4
//sbit	int0=P3^2;
//sbit key_add=P0^1;
//sbit key_dec=P0^2;

uchar Contrast_level=0x7f;
//bit log=0;


#define Write_Address 0x78    /*slave addresses with write*/
#define Read_Address 0x79     /*slave addresses with read*/

#define Start_column 0x00
#define Start_page  0x00
#define StartLine_set 0x00

void Delay1(uint n);
void Write_number(uchar *n,uchar k,uchar station_dot);
void display_Contrast_level(uchar number);
void adj_Contrast(void);
void Delay(uint n);
void Set_Page_Address(unsigned char add);
void Set_Column_Address(unsigned char add);
void Set_Contrast_Control_Register(unsigned char mod);
void initialise_oled(void);
void Display_Chess(unsigned char value);
void Display_Chinese(unsigned char ft[]);
void Display_Chinese_Column(unsigned char ft[]);
void Display_Picture(unsigned char pic[]);
void SentByte(unsigned char Byte);
void Check_Ack(void);//Acknowledge
void Stop(void);
void Start(void);
void Send_ACK(void);
unsigned char ReceiveByte(void);
void clear_oled(void);

void printxy(int x, int y, char ch);

uchar num[]={0x00,0xF8,0xFC,0x04,0x04,0xFC,0xF8,0x00,0x00,0x03,0x07,0x04,0x04,0x07,0x03,0x00,
	     0x00,0x00,0x08,0xFC,0xFC,0x00,0x00,0x00,0x00,0x00,0x04,0x07,0x07,0x04,0x00,0x00,  
	     0x00,0x18,0x1C,0x84,0xC4,0x7C,0x38,0x00,0x00,0x06,0x07,0x05,0x04,0x04,0x04,0x00,
	     0x00,0x08,0x0C,0x24,0x24,0xFC,0xD8,0x00,0x00,0x02,0x06,0x04,0x04,0x07,0x03,0x00,
	     0x80,0xE0,0x70,0x18,0xFC,0xFC,0x00,0x00,0x00,0x01,0x01,0x05,0x07,0x07,0x04,0x00,
	     0x00,0x7C,0x7C,0x24,0x24,0xE4,0xC4,0x00,0x00,0x03,0x07,0x04,0x04,0x07,0x03,0x00,
	     0x00,0xF0,0xF8,0x6C,0x24,0xEC,0xCC,0x00,0x00,0x03,0x07,0x04,0x04,0x07,0x03,0x00,
	     0x00,0x0C,0x0C,0xC4,0xFC,0x3C,0x04,0x00,0x00,0x00,0x00,0x07,0x07,0x00,0x00,0x00,
	     0x00,0x98,0xFC,0x64,0x64,0xFC,0x98,0x00,0x00,0x03,0x07,0x04,0x04,0x07,0x03,0x00,
	     0x00,0x78,0xFC,0x84,0xC4,0xFC,0xF8,0x00,0x00,0x06,0x06,0x04,0x06,0x03,0x01,0x00};



unsigned char font[]=
  {
   0x10,0x61,0x06,0xE0,0x00,0x26,0x22,0x1A,0x02,0xC2,0x0A,0x12,0x32,0x06,0x02,0x00,
   0x04,0xFC,0x03,0x20,0x20,0x11,0x11,0x09,0x05,0xFF,0x05,0x09,0x19,0x31,0x10,0x00,

   0x10,0x10,0x10,0xFE,0x10,0x10,0xFE,0x00,0x00,0xFC,0x00,0x00,0x00,0xFE,0x00,0x00,
   0x08,0x08,0x04,0x47,0x24,0x18,0x07,0x00,0x00,0x1F,0x00,0x00,0x00,0x7F,0x00,0x00,

   0x10,0x10,0x10,0xFF,0x10,0xF0,0x00,0x00,0xFE,0x22,0x22,0x22,0x22,0xFE,0x00,0x00,
   0x40,0x30,0x0E,0x01,0x00,0x3F,0x40,0x40,0x47,0x44,0x44,0x44,0x44,0x47,0x70,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x00,0x00,0xFE,0x42,0x42,0x42,0x42,0x42,0x42,0x42,0xFE,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x3F,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x3F,0x00,0x00,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x04,0x04,0xC4,0xB4,0x8C,0x87,0x84,0xF4,0x84,0x84,0x84,0x84,0x04,0x00,0x00,
   0x00,0x00,0x20,0x18,0x0E,0x04,0x20,0x40,0xFF,0x00,0x02,0x04,0x18,0x30,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x08,0x08,0x08,0x08,0x08,0x08,0xF9,0x4A,0x4C,0x48,0x48,0xC8,0x08,0x08,0x08,0x00,
   0x40,0x40,0x20,0x10,0x0C,0x03,0x00,0x00,0x20,0x40,0x40,0x3F,0x00,0x00,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x10,0x12,0x92,0x72,0xFE,0x51,0x91,0x00,0x22,0xCC,0x00,0x00,0xFF,0x00,0x00,0x00,
   0x04,0x02,0x01,0x00,0xFF,0x00,0x04,0x04,0x04,0x02,0x02,0x02,0xFF,0x01,0x01,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x08,0x08,0x88,0xFF,0x48,0x28,0x00,0xC8,0x48,0x48,0x7F,0x48,0xC8,0x48,0x08,0x00,
   0x01,0x41,0x80,0x7F,0x00,0x40,0x40,0x20,0x13,0x0C,0x0C,0x12,0x21,0x60,0x20,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x00,0xF8,0x48,0x48,0x48,0xC8,0x08,0xFF,0x08,0x09,0x0A,0xC8,0x88,0x08,0x00,
   0x40,0x30,0x0F,0x00,0x08,0x50,0x4F,0x20,0x10,0x0B,0x0C,0x12,0x21,0x40,0xF0,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x10,0x10,0x90,0x10,0x10,0x11,0x16,0x10,0x10,0xF0,0x50,0x10,0x10,0x00,0x00,
   0x40,0x40,0x40,0x40,0x43,0x4E,0x40,0x60,0x58,0x47,0x40,0x40,0x40,0x60,0x40,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x40,0x40,0x42,0x42,0x42,0x42,0x42,0xFE,0x42,0x42,0x42,0x42,0x42,0x42,0x40,0x00,
   0x00,0x00,0x00,0x00,0x20,0x40,0x80,0x7F,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x06,0x04,0x00,0x00,0x00,
   0x00,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x18,0x10,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x0C,0x04,0x55,0x55,0x55,0x85,0x7F,0x85,0x55,0x55,0x55,0x05,0x0C,0x04,0x00,
   0x04,0x04,0x04,0x0A,0x0A,0x09,0x2A,0xCC,0x28,0x19,0x09,0x02,0x06,0x02,0x02,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x0C,0x04,0x55,0x55,0x55,0x85,0x7F,0x85,0x55,0x55,0x55,0x05,0x0C,0x04,0x00,
   0x04,0x04,0x04,0x0A,0x0A,0x09,0x2A,0xCC,0x28,0x19,0x09,0x02,0x06,0x02,0x02,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x00,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x04,0x06,0x04,0x00,0x00,0x00,
   0x00,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x10,0x18,0x10,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x40,0x20,0x10,0x0C,0xE3,0x22,0x22,0x22,0xFE,0x22,0x22,0x22,0x22,0x02,0x00,0x00,
   0x04,0x04,0x04,0x04,0x07,0x04,0x04,0x04,0xFF,0x04,0x04,0x04,0x04,0x04,0x04,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x04,0xFF,0x54,0x54,0x54,0xFF,0x04,0x00,0xFE,0x22,0x22,0x22,0xFE,0x00,0x00,
   0x42,0x22,0x1B,0x02,0x02,0x0A,0x33,0x62,0x18,0x07,0x02,0x22,0x42,0x3F,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x20,0x10,0x08,0xC7,0x3A,0x50,0x44,0x44,0x44,0x7F,0x44,0xC4,0x44,0x44,0x40,0x00,
   0x00,0x02,0x01,0xFF,0x00,0x02,0x02,0x1A,0x02,0x42,0x82,0x7F,0x02,0x02,0x02,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x44,0x54,0x54,0x55,0x56,0xD4,0x7C,0x54,0x54,0x56,0x55,0x54,0x44,0x44,0x00,
   0x08,0x08,0x04,0x04,0x02,0xFF,0x55,0x55,0x55,0x55,0x55,0x55,0xFF,0x00,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x80,0x40,0x30,0xFC,0x03,0x90,0x68,0x06,0x04,0xF4,0x04,0x24,0x44,0x8C,0x04,0x00,
   0x00,0x20,0x38,0x03,0x38,0x40,0x40,0x49,0x52,0x41,0x40,0x70,0x00,0x09,0x30,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x80,0x84,0x84,0x94,0xA4,0xC4,0xFF,0x84,0xC4,0xB4,0x94,0x84,0x84,0x80,0x00,
   0x20,0x20,0x10,0x10,0x08,0x04,0x02,0xFF,0x01,0x02,0x04,0x08,0x18,0x30,0x10,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x00,0xF8,0x48,0x48,0x48,0x48,0xFF,0x48,0x48,0x48,0x48,0xF8,0x00,0x00,0x00,
   0x00,0x00,0x0F,0x04,0x04,0x04,0x04,0x3F,0x44,0x44,0x44,0x44,0x4F,0x40,0x70,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x80,0x84,0x84,0x94,0xA4,0xC4,0xFF,0x84,0xC4,0xB4,0x94,0x84,0x84,0x80,0x00,
   0x20,0x20,0x10,0x10,0x08,0x04,0x02,0xFF,0x01,0x02,0x04,0x08,0x18,0x30,0x10,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0xE0,0x02,0x12,0xE2,0x42,0x02,0xF2,0x12,0x8A,0x66,0x47,0x02,0xE0,0x00,0x00,
   0x00,0x7F,0x20,0x24,0x24,0x2A,0x31,0x2F,0x21,0x22,0x24,0x2C,0x20,0x7F,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x20,0x20,0x22,0x22,0xFE,0x21,0x21,0x20,0x20,0xFF,0x20,0x22,0xAC,0x20,0x20,0x00,
   0x04,0x04,0x42,0x82,0x7F,0x01,0x01,0x10,0x10,0x08,0x07,0x1A,0x21,0x40,0xF0,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x80,0x40,0xF0,0x1C,0x03,0xF0,0x01,0x0E,0x04,0x00,0x04,0x04,0x04,0xFC,0x00,0x00,
   0x00,0x00,0x7F,0x00,0x00,0x7F,0x00,0x00,0x00,0x00,0x00,0x20,0x40,0x3F,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x04,0x04,0x04,0xF4,0x54,0x5C,0x57,0x54,0x54,0x54,0xF4,0x04,0x06,0x04,0x00,
   0x10,0x90,0x90,0x50,0x5F,0x35,0x15,0x15,0x15,0x35,0x55,0x5F,0x90,0x90,0x10,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x20,0x21,0xE6,0x02,0x08,0xF8,0x88,0x88,0x88,0x08,0xFF,0x08,0x0A,0xCC,0x88,0x00,
   0x00,0x00,0x3F,0x90,0x68,0x1F,0x20,0x40,0x3F,0x20,0x10,0x0F,0x14,0x23,0x78,0x00,

   /*--  ����:  Ϊ  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x10,0x10,0x12,0x14,0x1C,0x10,0xF0,0x9F,0x10,0x10,0x10,0x10,0xF8,0x10,0x00,
   0x00,0x00,0x40,0x20,0x10,0x08,0x06,0x01,0x00,0x11,0x26,0x40,0x20,0x1F,0x00,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x80,0x40,0x30,0xFC,0x03,0x90,0x68,0x06,0x04,0xF4,0x04,0x24,0x44,0x8C,0x04,0x00,
   0x00,0x20,0x38,0x03,0x38,0x40,0x40,0x49,0x52,0x41,0x40,0x70,0x00,0x09,0x30,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x00,0x00,0xFF,0x91,0x91,0xFF,0x00,0x00,0xFF,0xC1,0x41,0x49,0x51,0xCF,0x00,0x00,
   0x40,0x30,0x0F,0x20,0x40,0x3F,0x00,0x00,0x7F,0x21,0x16,0x08,0x36,0x61,0x20,0x00,

   /*--  ����:  ��  --*/
   /*--  ����12;  �������¶�Ӧ�ĵ���Ϊ����x��=16x16   --*/
   0x20,0x10,0x10,0x88,0x84,0x4F,0x52,0xA2,0x22,0x52,0x4A,0x86,0x80,0x80,0x80,0x00,
   0x80,0x81,0x41,0x42,0x22,0x12,0x0E,0x03,0x02,0x42,0x82,0x7E,0x00,0x01,0x00,0x00

  };


unsigned char pic[]=
  {/*--  ������һ��ͼ��E:\��ʾ��ͼƬ\ER-OLED023-1.bmp  --*/
   /*--  ����x�߶�=128x32  --*/
   0xFF,0x01,0x01,0xFD,0x25,0x25,0x25,0x25,0x01,0xE1,0x59,0x45,0x59,0xE1,0x01,0x99,
   0x25,0x25,0xC9,0x01,0x05,0x05,0xFD,0x05,0x05,0x01,0xFD,0x25,0x25,0x65,0x99,0x01,
   0x01,0xFD,0x01,0x01,0x99,0x25,0x25,0xC9,0x01,0x01,0xFD,0x01,0x01,0xFD,0x19,0x21,
   0xC1,0xFD,0x01,0x01,0xF9,0x05,0x05,0x25,0xE9,0x01,0x01,0x01,0x01,0x05,0x05,0xFD,
   0x05,0x05,0x01,0xFD,0x25,0x25,0x25,0x25,0x01,0xF9,0x05,0x05,0x05,0x89,0x01,0x01,
   0xFD,0x21,0x21,0x21,0xFD,0x01,0x01,0x01,0x01,0x01,0xF9,0x05,0x05,0x05,0x89,0x01,
   0x01,0xF9,0x05,0x05,0x05,0xF9,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0x01,0xFD,0x01,
   0x01,0x01,0x05,0x05,0xFD,0x05,0x05,0x01,0xFD,0x05,0x05,0x05,0xF9,0x01,0x01,0xFF,
   0xFF,0x00,0x00,0x01,0x01,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x01,0x00,
   0x01,0x01,0x00,0x00,0x00,0x00,0x01,0xF0,0xF0,0x90,0x91,0x90,0x00,0xF0,0xF1,0x10,
   0x10,0xF1,0xE0,0x00,0x00,0x01,0x01,0x00,0xC0,0xE0,0x31,0x10,0x30,0xE1,0xC0,0x00,
   0xF0,0xF1,0x00,0x00,0x00,0x01,0x01,0xF1,0xF0,0x90,0x90,0x90,0x00,0xF0,0xF0,0x11,
   0x10,0xF0,0xE0,0x01,0xE1,0xF1,0x11,0xF1,0xE0,0x00,0x21,0x31,0x11,0xF0,0xE0,0x00,
   0x21,0x30,0x90,0xF0,0x61,0x00,0x00,0x01,0x00,0x00,0xC0,0x61,0xF1,0xF1,0x00,0x00,
   0x00,0x00,0x01,0x01,0x01,0x00,0x00,0x00,0x01,0x00,0x00,0x03,0x00,0x00,0x01,0x01,
   0x01,0x01,0x00,0x00,0x01,0x00,0x00,0x00,0x01,0x01,0x01,0x01,0x00,0x00,0x00,0xFF,
   0xFF,0x00,0x00,0x00,0x00,0x80,0xC0,0xC0,0x00,0x00,0x80,0xC0,0x40,0xC0,0x80,0x00,
   0x80,0xC0,0x40,0xC0,0x80,0x00,0x80,0xCF,0x8F,0x08,0x88,0xC8,0x40,0xCF,0x8F,0x01,
   0x83,0xC7,0x4C,0xC8,0x82,0x02,0x02,0x00,0x03,0x07,0x0C,0x08,0x0C,0xC7,0xC3,0x00,
   0x0F,0x0F,0x08,0x08,0x08,0x08,0x00,0x8F,0xCF,0x08,0x08,0x08,0x00,0x0F,0x0F,0x08,
   0x08,0x0F,0x07,0x00,0x07,0x0F,0x08,0x0F,0x07,0x00,0x0C,0x8E,0xCB,0x49,0xC8,0x80,
   0x04,0x0C,0x08,0x0F,0x87,0xC0,0x42,0xC2,0x82,0x00,0x40,0x40,0x0F,0x0F,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xC0,0xC0,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFF,
   0xFF,0x80,0x80,0x80,0x83,0x81,0xBF,0xBF,0x80,0x80,0xB0,0xB8,0xAC,0xA7,0xA3,0x80,
   0x9D,0xBF,0xA2,0xBF,0x9D,0x80,0x82,0x81,0x82,0x80,0x90,0xB0,0xA2,0xBF,0x9D,0x80,
   0xB0,0xB8,0xAC,0xA7,0xA3,0x80,0x80,0x80,0x80,0x9E,0xBF,0xA1,0xA1,0xBF,0xBF,0x80,
   0x9E,0xBF,0xA1,0xA1,0xBF,0x9E,0x81,0x9F,0xBF,0xA1,0x80,0x96,0xB7,0xAD,0xAD,0xBB,
   0x9A,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0xB0,0xB8,0xAC,0xA7,0xA3,
   0x80,0xB0,0xB0,0x80,0x90,0xB0,0xA2,0xBF,0x9D,0x80,0xBF,0xBF,0x80,0xBF,0xBF,0x81,
   0x81,0xBF,0xBE,0x80,0x9E,0xBF,0xA1,0xB3,0x92,0x80,0xBF,0xBF,0x81,0x81,0xBF,0xBE,
   0x80,0x9E,0xBF,0xA5,0xA5,0xB7,0x96,0x80,0x96,0xB7,0xAD,0xAD,0xBB,0x9A,0x80,0xFF


  };


unsigned char pic1[]=
  {/*--  ������һ��ͼ��E:\��ʾ��ͼƬ\128321.bmp  --*/
   /*--  ����x�߶�=128x32  --*/
   0xFF,0x01,0x01,0xE1,0x21,0x21,0x31,0x29,0x21,0x21,0x21,0xE1,0x01,0x01,0x01,0x01,
   0xF9,0x89,0x89,0x89,0x89,0x89,0x89,0xF9,0x01,0x01,0x81,0xC1,0x39,0x21,0x21,0xA1,
   0x79,0xA1,0x21,0xB1,0x21,0x01,0x01,0xC1,0x01,0x01,0x01,0xF9,0x01,0x01,0x01,0xC1,
   0x01,0x01,0x01,0x01,0xF9,0x49,0x49,0x49,0xC9,0x49,0x49,0x79,0x01,0x01,0x01,0x01,
   0x01,0x41,0x51,0x51,0x79,0x51,0xD1,0x51,0x79,0x51,0x51,0x41,0x01,0x49,0x91,0xC1,
   0x11,0xD1,0x51,0x51,0xD1,0x11,0xF9,0x11,0x01,0x01,0x01,0x01,0x09,0x89,0x71,0x81,
   0x01,0x01,0x01,0x01,0x01,0xC9,0x11,0xC1,0x21,0xD9,0x51,0x51,0x51,0x51,0xD1,0x11,
   0x01,0x89,0x31,0x81,0x11,0x91,0xD1,0xB9,0x91,0xD1,0x91,0x11,0x01,0x01,0x01,0xFF,
   0xFF,0x00,0x00,0x3F,0x22,0x22,0x22,0x22,0x22,0x22,0x22,0x3F,0x00,0x00,0x00,0x00,
   0x3F,0x10,0x10,0x10,0x10,0x10,0x10,0x3F,0x00,0x00,0x00,0x3F,0x00,0x02,0x01,0x3F,
   0x10,0x03,0x0D,0x10,0x20,0x00,0x00,0x1F,0x10,0x10,0x10,0x1F,0x10,0x10,0x10,0x3F,
   0x00,0x00,0x08,0x04,0x03,0x10,0x12,0x14,0x24,0x21,0x02,0x04,0x04,0x40,0x30,0x00,
   0x00,0x20,0x20,0x3F,0x15,0x15,0x1F,0x15,0x15,0x3F,0x20,0x20,0x00,0x08,0x3E,0x01,
   0x00,0x07,0x04,0x04,0x27,0x20,0x3F,0x00,0x00,0x20,0x10,0x08,0x06,0x01,0x00,0x01,
   0x06,0x08,0x10,0x20,0x00,0x3C,0x03,0x02,0x0E,0x0B,0x0A,0x2F,0x2A,0x3E,0x0B,0x0A,
   0x00,0x08,0x3D,0x23,0x10,0x0E,0x00,0x3E,0x00,0x3E,0x21,0x38,0x00,0x30,0x30,0xFF,
   0xFF,0x00,0x48,0xA6,0x90,0x98,0xA2,0x44,0x10,0xEE,0x08,0x08,0x18,0x00,0x48,0x4C,
   0xA4,0x94,0xEC,0x86,0x84,0x8C,0x94,0xA4,0x0C,0x00,0x20,0x24,0x24,0x24,0x24,0xFC,
   0x22,0x22,0x22,0x20,0x20,0x00,0x00,0x00,0xFE,0x52,0x52,0xFE,0x52,0x52,0x52,0xFE,
   0x00,0x00,0x00,0x00,0xFE,0x92,0x92,0x92,0x92,0x92,0xFE,0x00,0x00,0x00,0x00,0x00,
   0x00,0x02,0x02,0xFA,0xAA,0xAA,0xFE,0xAA,0xAA,0xAA,0xFA,0x02,0x00,0x00,0x00,0x00,
   0x00,0x00,0xFE,0x20,0x20,0x20,0x20,0x00,0x00,0x40,0x40,0x40,0x40,0x40,0x40,0x40,
   0x40,0x40,0x60,0x40,0x00,0x00,0xFE,0x8A,0xAA,0xAA,0xAA,0xAA,0xAA,0xAA,0xAE,0x80,
   0x00,0x88,0x68,0xFE,0x48,0x2A,0x1C,0xC8,0x3E,0x18,0x2C,0x4A,0x00,0x00,0x00,0xFF,
   0xFF,0x80,0x80,0x8F,0x84,0x84,0x8F,0x84,0x82,0x81,0x83,0x84,0x88,0x80,0x88,0x88,
   0x88,0x84,0x83,0x80,0x88,0x88,0x88,0x87,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x8F,
   0x80,0x80,0x80,0x80,0x80,0x80,0x88,0x8A,0x8A,0x8A,0x8A,0x8F,0x8A,0x8A,0x8A,0x8A,
   0x88,0x80,0x80,0x80,0x8F,0x84,0x84,0x84,0x84,0x84,0x8F,0x80,0x80,0x90,0x8C,0x80,
   0x80,0x88,0x88,0x88,0x85,0x82,0x85,0x88,0x88,0x88,0x88,0x88,0x80,0x88,0x88,0x88,
   0x88,0x88,0x8F,0x88,0x88,0x88,0x88,0x88,0x80,0x80,0x80,0x80,0x80,0x80,0x80,0x80,
   0x80,0x80,0x80,0x80,0x80,0x8C,0x83,0x80,0x88,0x8C,0x8B,0x88,0x8A,0x8C,0x88,0x80,
   0x80,0x81,0x80,0x8F,0x81,0x89,0x8B,0x8B,0x85,0x87,0x89,0x89,0x80,0x8C,0x8C,0xFF

  };

unsigned char pic2[]=
  {
   /*--  ������һ��ͼ��E:\��ʾ��ͼƬ\128323.bmp  --*/
   /*--  ����x�߶�=128x32  --*/
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0xF8,0x08,0x08,0xF8,0x08,0x08,0xF0,0x00,0xF8,0x88,
   0x88,0x70,0x00,0x44,0x82,0x92,0x6C,0x00,0x00,0x00,0x00,0xF8,0x08,0x08,0xF8,0x08,
   0x08,0xF0,0x00,0x70,0xA8,0xA8,0xB0,0x00,0x70,0x88,0x88,0xFE,0x00,0xFA,0x00,0xC8,
   0xA8,0xA8,0xF8,0x00,0x00,0x00,0x00,0xF8,0x88,0x88,0x70,0x00,0xFE,0x00,0xC8,0xA8,
   0xA8,0xF8,0x00,0x08,0x70,0x80,0x70,0x08,0x00,0x70,0xA8,0xA8,0xB0,0x00,0xF8,0x08,
   0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0xE0,0x00,0x80,0x80,0x80,0x00,0x00,0x00,0x00,0x00,0x80,0x83,0x80,
   0x80,0x80,0x80,0x00,0x00,0x80,0x00,0x00,0x00,0x80,0x00,0x00,0x00,0x00,0xE0,0x80,
   0x80,0x00,0x00,0x00,0x80,0x80,0x00,0x00,0x80,0x80,0x80,0x80,0x00,0x80,0x80,0x80,
   0xC0,0x80,0x00,0x00,0x00,0x00,0x00,0x03,0x00,0x00,0x00,0x00,0x80,0x80,0x80,0x80,
   0x80,0x80,0x00,0x00,0x02,0x81,0x80,0x00,0x00,0xE0,0x80,0x80,0x00,0x00,0x80,0x00,
   0x00,0x00,0x80,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x0F,0x00,0x0F,0x00,0x00,0x0F,0x00,0x00,0x00,0x00,0x0F,0x00,0x00,
   0x0F,0x00,0x00,0x0F,0x00,0x00,0x27,0x18,0x07,0x00,0x00,0x00,0x00,0x00,0x0F,0x00,
   0x00,0x0F,0x00,0x07,0x0A,0x0A,0x0B,0x00,0x0C,0x0A,0x0A,0x0F,0x00,0x0F,0x00,0x00,
   0x0F,0x08,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x0F,0x00,0x00,0x0F,
   0x00,0x00,0x0F,0x00,0x07,0x08,0x08,0x07,0x00,0x0F,0x08,0x08,0x07,0x00,0x00,0x27,
   0x18,0x07,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0xFE,0xFE,0x38,0x7C,0xFE,0x10,0x38,0x7C,0xFE,0x00,0x00,0x00,0x00,0xFE,0xFE,0x00,
   0xFE,0xFE,0x00,0x00,0x00,0x00,0x00,0xFE,0x7C,0x38,0x10,0xFE,0x7C,0x38,0xFE,0xFE,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0xFC,0x82,0x82,0x7C,0x00,0x00,
   0x04,0xFE,0x00,0x00,0x00,0x88,0x00,0x58,0x8E,0x8A,0x72,0x00,0x84,0xC2,0xB2,0x8C,
   0x00,0xC0,0x38,0x06,0x44,0x82,0x92,0x6C,0x00,0x00,0x88,0x00,0x58,0x8E,0x8A,0x72,
   0x00,0x6C,0x92,0x92,0x6C,0x00,0x00,0x00,0x00,0x00,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,
   0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x7C,0x44,0x44,
   0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x44,0x7C,0x00

  };

unsigned char pic3[]=
  {
   /*--  ������һ��ͼ��E:\��ʾ��ͼƬ\128324.bmp  --*/
   /*--  ����x�߶�=128x32  --*/
   0xFF,0xFF,0x03,0x03,0x03,0x03,0x03,0x03,0x01,0x01,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x4C,0x92,0x92,0x64,0x00,0xC2,0xA2,
   0x92,0x8A,0x86,0x82,0x00,0x00,0x00,0x00,0xFE,0x92,0x92,0x92,0x92,0x80,0x70,0x2C,
   0x22,0x2C,0x70,0x80,0x4C,0x92,0x92,0x64,0x00,0x02,0x02,0xFE,0x02,0x02,0x00,0x00,
   0x00,0x00,0xFE,0x12,0x12,0x32,0xCC,0x00,0x00,0xFE,0x00,0x00,0x4C,0x92,0x92,0x64,
   0x00,0x00,0xFE,0x00,0x00,0xFE,0x0C,0x10,0x60,0xFE,0x00,0x00,0x7C,0x82,0x82,0x92,
   0x74,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,0x00,
   0x00,0x00,0x00,0x00,0x00,0x00,0x01,0x01,0x03,0x03,0x03,0x03,0x03,0x03,0xFF,0xFF,
   0x03,0x20,0x10,0xF8,0x00,0x00,0x00,0x10,0x08,0x08,0x88,0x70,0x00,0xB0,0x48,0x48,
   0x48,0xB0,0x00,0x50,0x38,0x50,0x00,0x10,0x08,0x48,0x48,0xB0,0x00,0x10,0x08,0x08,
   0x88,0x70,0x00,0x00,0x00,0x00,0xC0,0x20,0x20,0x40,0xF8,0x00,0xC0,0x20,0x20,0x20,
   0xC0,0x20,0xF8,0x20,0x00,0x40,0xA0,0xA0,0x20,0x40,0x00,0x00,0x00,0xE0,0x10,0x10,
   0x10,0xE0,0x00,0x00,0xF0,0x00,0x00,0x00,0x00,0x00,0xF0,0x90,0x90,0x90,0x00,0x00,
   0xF0,0x10,0x10,0x10,0xE0,0x00,0x00,0x00,0x00,0x00,0xF0,0x10,0x10,0x10,0xE0,0x00,
   0x00,0xF0,0x00,0x00,0x60,0x90,0x90,0x20,0x00,0x00,0xF0,0x90,0x90,0x60,0x00,0x00,
   0xF0,0x00,0x00,0x00,0x00,0x00,0xE0,0x10,0xE0,0x00,0x30,0x40,0x80,0x40,0x30,0x01,
   0xC0,0x00,0x00,0x87,0x80,0x00,0x00,0x84,0x06,0x05,0x84,0x84,0x00,0x83,0x84,0x04,
   0x04,0x83,0x00,0x00,0x80,0x80,0x00,0x82,0x84,0x04,0x04,0x83,0x00,0x04,0x86,0x85,
   0x04,0x04,0x00,0x00,0xE0,0xE0,0x83,0x84,0x84,0x02,0x07,0x80,0x83,0x04,0x04,0x84,
   0x83,0x80,0x87,0x04,0x00,0x02,0x84,0x84,0x05,0x02,0x00,0x00,0x00,0x83,0x84,0x84,
   0xE4,0xE3,0x00,0xA0,0xA7,0x04,0x04,0x84,0x80,0x80,0x87,0x04,0x04,0x84,0x80,0x80,
   0x87,0x84,0x04,0x04,0xE3,0xE0,0x00,0x00,0x80,0x80,0x87,0x04,0x84,0x84,0x03,0x00,
   0x00,0x87,0x80,0x00,0x02,0x04,0x04,0x83,0x80,0x80,0x07,0x00,0x00,0x80,0x80,0x80,
   0x87,0x04,0x04,0x84,0x80,0x86,0x81,0x81,0x81,0x86,0x80,0x80,0x07,0x00,0x00,0xC0,
   0xFF,0xFF,0xC0,0xC3,0xDF,0xDC,0xCF,0x83,0x8F,0x1C,0x1F,0x03,0x00,0x03,0x1F,0x1C,
   0x0F,0x03,0x0F,0x1C,0x1F,0x03,0x00,0x03,0x1F,0x1C,0x0F,0x03,0x0F,0x1C,0x1F,0x03,
   0x00,0x18,0x18,0x00,0x1F,0x1F,0x10,0x10,0x1F,0x0F,0x00,0x0F,0x1F,0x10,0x10,0x1F,
   0x1F,0x40,0x47,0x7F,0x38,0x1F,0x07,0x00,0x04,0x04,0x04,0x00,0x0F,0x1F,0x10,0x10,
   0x1F,0x1F,0x00,0x1F,0x1F,0x00,0x0B,0x1B,0x16,0x16,0x1D,0x0D,0x00,0x7F,0x7F,0x10,
   0x10,0x1F,0x0F,0x00,0x1F,0x1F,0x00,0x0D,0x1E,0x12,0x1F,0x1F,0x40,0x47,0x7F,0x38,
   0x1F,0x07,0x00,0x18,0x18,0x00,0x0F,0x1F,0x10,0x19,0x09,0x00,0x0F,0x1F,0x10,0x10,
   0x1F,0x0F,0x00,0x1F,0x1F,0x00,0x80,0x9F,0xDF,0xC0,0xC0,0xDF,0xDF,0xC0,0xFF,0xFF,
  };

#if 0
void Step(void) interrupt 0 using 0
{
  Delay1(300);
  if(int0==0)
    // { while(IE0);
    log=!log;
  // }
  while(!int0);
  return;

}
#endif




void Delay1(uint n)
{
  //  n /= 100;
  while(n--)
    {
      _nop_();
    }
}


void Write_number(uchar *n,uchar k,uchar station_dot)
{
  uchar i; 
  Start();
  SentByte(Write_Address);
  SentByte(0x40);
  for(i=0;i<8;i++)
    {
      SentByte(*(n+16*k+i));
    }
  Stop();
    

  Set_Page_Address(Start_page+1) ;
  Set_Column_Address(Start_column+station_dot*8); 
  Start();
  SentByte(Write_Address);
  SentByte(0x40);
  for(i=8;i<16;i++)
    {
      SentByte(*(n+16*k+i));
    }
  Stop();

}



void display_Contrast_level(uchar number)
{ uchar number1,number2,number3;
  number1=number/100;number2=number%100/10;number3=number%100%10;
  Set_Column_Address(Start_column+0*8);
  Set_Page_Address(Start_page);
  Write_number(num,number1,0);
  Set_Column_Address(Start_column+1*8);
  Set_Page_Address(Start_page);
  Write_number(num,number2,1);
  Set_Column_Address(Start_column+2*8);
  Set_Page_Address(Start_page);
  Write_number(num,number3,2);

}

#if 0
void adj_Contrast(void)
{ Delay1(300);
  if((key_add==0)||(key_dec==0))
    {  
      if (key_add==0) 
	{Contrast_level+=1;
	  Set_Contrast_Control_Register(Contrast_level); 
	  display_Contrast_level(Contrast_level);
	  Delay1(18000);
	  if(key_add==0)
	    {Delay1(18000);
	      if(key_add==0)   
		{Delay1(18000);
		  if(key_add==0)
		    {Delay1(18000);
		      if(key_add==0)

			{while(key_add==0)
			    {Contrast_level+=1; 
			      Set_Contrast_Control_Register(Contrast_level); 
			      display_Contrast_level(Contrast_level);
			      Delay1(20000); 
			    }
			}
		    }    
		}      
	    }            
	}



    
 
      if (key_dec==0) 
	{Contrast_level-=1; 
	  Set_Contrast_Control_Register(Contrast_level); 
	  display_Contrast_level(Contrast_level);
	  Delay1(18000);
	  if(key_dec==0)
	    {Delay1(18000);
	      if(key_dec==0)   
		{Delay1(18000);
		  if(key_dec==0)
		    {Delay1(18000);
		      if(key_dec==0)

			{while(key_dec==0)
			    {Contrast_level-=1; 
			      Set_Contrast_Control_Register(Contrast_level); 
			      display_Contrast_level(Contrast_level);
			      Delay1(20000); 
			    }
			}
		    }    
		}      
	    }            
	}

    }
}

#endif


void Delay(uint d)
{
  volatile uint n = d;
  
  d*=100;
  while(d)
    {
      d--;
    }
}

void SDA0(void)
{
  // Output 0 by driving low
  gpio_put(PIN_I2C_SDA, 0);
  gpio_set_dir(PIN_I2C_SDA, GPIO_OUT);
}

void SDA1(void)
{
  // Output 1 by switching to input
  gpio_put(PIN_I2C_SDA, 1);
  gpio_set_dir(PIN_I2C_SDA, GPIO_OUT);
}

void SCL0(void)
{
  // Output 0 by driving low
  gpio_put(PIN_I2C_SCL, 0);
  gpio_set_dir(PIN_I2C_SCL, GPIO_OUT);
}

void SCL1(void)
{
  // Output 1 by switching to input
  gpio_put(PIN_I2C_SCL, 1);
  gpio_set_dir(PIN_I2C_SCL, GPIO_OUT);
}

int READSDA(void)
{
  gpio_set_dir(PIN_I2C_SDA, GPIO_IN);
  return(gpio_get(PIN_I2C_SDA));
}

void _nop_(void)
{
  volatile int i = 0;

  for(i=0; i<10; i++)
    {
    }
  
}

void Start(void)
{
  SDA1();
  _nop_();
  SCL1();
  _nop_();
  SDA0();
  _nop_();
  SCL0();
} 


void Stop(void)
{
  //SCL0();
  _nop_();
  SDA0();
  _nop_();
  SCL1();
  _nop_();
  SDA1();
} 


void Check_Ack(void)//Acknowledge
{
  unsigned char ack=1;
  gpio_set_dir(PIN_I2C_SDA, GPIO_IN);
  //SDA1();
  SCL1();
  _nop_();
  while(ack==1)
    {
#if IGNORE_ACK      
      ack = 0;
      for(int i=0; i<100; i++)
	{
	  _nop_();
	}
#else
      ack = READSDA();
#endif
    }
  _nop_();
  SCL0();
  return;
}


void SentByte(unsigned char Byte)
{
#if 1
  uchar i;
  
  for(i=0;i<8;i++)
    {
      SCL0();
      _nop_();  
      if((Byte&0x80)==0x80)
	{
	  SDA1();
	}
      
      else
	{
	  SDA0();
	}
      
      SCL1();
      _nop_();  
      Byte=Byte<<1;
    }
  
  SCL0();
  Check_Ack();
#else
  i2c_write_byte(Byte);
#endif  
}

unsigned char ReceiveByte(void)
{
  uchar i,rudata=0;
  SCL0();
  SDA1();
  
  for(i=0;i<8;i++)
    {
      SCL1();
      _nop_(); 
      if (READSDA()==1)
	{
	  rudata|=0x01;
	}
      else
	{
	  rudata|=0x00;
	}
      rudata=rudata<<1;
      SCL0();
      _nop_(); 
    }
  
  Send_ACK();
  return rudata;
}

void Send_ACK(void)
{
  SCL0();
  SDA0();
  _nop_(); 
  SCL1();
  SCL0();
}


// Set page address 0~4
void Set_Page_Address(unsigned char add)
{
  Start();
  SentByte(Write_Address);
  SentByte(0x80);
  add=0xb0|(add & 0x7);
  SentByte(add);
  _nop_();
  Stop();
  return;
}

void Set_Column_Address(unsigned char add)
{
  Start();
  SentByte(Write_Address);
  SentByte(0x80);
  SentByte((0x10|(add>>4)));
  SentByte(0x80);
  SentByte((0x0f&add)|0x00);
  Stop();
  return;
}



void Set_Contrast_Control_Register(unsigned char mod)
{
  Start();
  SentByte(Write_Address);
  SentByte(0x80);
  SentByte(0x81);
  SentByte(0x80);
  SentByte(mod);
  Stop();
  return;
}

void RST0(void)
{
  write_595(PIN_LATCHOUT1, 0x00);
}

void RST1(void)
{
  write_595(PIN_LATCHOUT1, 0x80);
}


#pragma disable
void initialise_oled(void)
{
  //while(1)
  {
    RST1();
    Delay(2000);
    RST0();
    Delay(2000);
    RST1();

  
    Delay(2000);

    Start();
    SentByte(Write_Address);
    SentByte(0x80);
    SentByte(0xae);//--turn off oled panel

    SentByte(0x80);
    SentByte(0xd5);//--set display clock divide ratio/oscillator frequency
    SentByte(0x80);
    SentByte(0xa0);//--set divide ratio

    SentByte(0x80);  
    SentByte(0xa8);//--set multiplex ratio(1 to 64)
    SentByte(0x80);
    SentByte(0x1f);//--1/32 duty

    SentByte(0x80);
    SentByte(0xd3);//-set display offset
    SentByte(0x80);
    SentByte(0x00);//-not offset

    SentByte(0x80);
    SentByte(0xad);//--Set Master Configuration
    SentByte(0x80);
    SentByte(0x8e);//--

    SentByte(0x80);
    SentByte(0xd8);//--Set Area Color Mode On/Off & Low Power Display Mode
    SentByte(0x80);
    SentByte(0x05);//

    SentByte(0x80);
    SentByte(0xa1);//--set segment re-map 128 to 0

    SentByte(0x80);
    SentByte(0xC8);//--Set COM Output Scan Direction 64 to 1

    SentByte(0x80);
    SentByte(0xda);//--Set COM Pins Hardware Configuration
    SentByte(0x80);
    SentByte(0x12);

    SentByte(0x80);
    SentByte(0x91);//--Set current drive pulse width of BANK0, Color A, Band C.
    SentByte(0x80);
    SentByte(0x3f);
    SentByte(0x80);
    SentByte(0x3f);
    SentByte(0x80);
    SentByte(0x3f);
    SentByte(0x80);
    SentByte(0x3f);

    SentByte(0x80);
    SentByte(0x81);//--set contrast control register
    SentByte(0x80);
    SentByte(Contrast_level);

    SentByte(0x80);
    SentByte(0xd9);//--set pre-charge period
    SentByte(0x80);
    SentByte(0xd2);

    SentByte(0x80);
    SentByte(0xdb);//--set vcomh
    SentByte(0x80);
    SentByte(0x34);

    SentByte(0x80);
    SentByte(0xa6);//--set normal display

    SentByte(0x80);
    SentByte(0xa4);//Disable Entire Display On 

    SentByte(0x80);
    SentByte(0xaf);//--turn on oled panel

  
    Stop();

  }
}



void Display_Chess(unsigned char value)
{
  unsigned char i,j,k;
  value = 0;
  
  // bank 0, 1 are top half of screen
  
  for(i=0; i<4; i++)
    {
      Set_Page_Address(i);

      Set_Column_Address(0x00);

      Start();
      
      SentByte(Write_Address);
      SentByte(0x40);

      for(j=0; j<16; j++)
	{
	  for(k=0; k<4; k++)
	    {
	    SentByte(value++);
	    }
	  
	  for(k=0; k<4; k++)
	    {
	    SentByte(value++);
	    }
	}
      Stop();
    }
}


void Display_Chinese(unsigned char ft[])
{
  unsigned char i,j,k,b,c=0;
  unsigned int num=0;

  for(b=0;b<2;b++)
    {
      for(i=0;i<0x02;i++)
	{
	  Set_Page_Address(c);
	  Set_Column_Address(0x00);
	  num=i*0x10+b*256;
	  Start();
	  SentByte(Write_Address);
	  SentByte(0x40);
	  for(j=0;j<0x08;j++)
	    {
	      for(k=0;k<0x10;k++)
		{
		  SentByte(ft[num+k]);
		}
	      num+=0x20;
	    }c++;
	  Stop();
	}
    }
  return;
}


//Display_Chinese1
void Display_Chinese_Column(unsigned char ft[])
{
  unsigned char i,j,k,num=0x40;
  for(i=0;i<0x04;i++)
    {
      Set_Page_Address(i);
      Set_Column_Address(0x00);
      Start();
      SentByte(Write_Address);
      SentByte(0x40);
      for(j=0;j<0x08;j++)
	{
	  for(k=0;k<0x10;k++)
	    {
	      SentByte(ft[num+k]);
	    }
	}
      Stop();
      num+=0x10;
    }
  return;
}


void Display_Picture(unsigned char pic[])
{
  unsigned char i,j,num=0;
  for(i=0;i<0x04;i++)
    {
      Set_Page_Address(i);
      Set_Column_Address(0x00);
      Start();
      SentByte(Write_Address);
      SentByte(0x40);
      for(j=0;j<0x80;j++)
	{
	  SentByte(pic[i*0x80+j]);
	}
      Stop();
    }
  return;
}

void clear_oled(void)
{
  unsigned char i,j,num = 0;
  
  for(i=0; i<0x04; i++)
    {
      Set_Page_Address(i);
      Set_Column_Address(0x00);
      
      Start();
      SentByte(Write_Address);
      SentByte(0x40);
      
      for(j=0;j<0x80;j++)
	{
	  SentByte(0);
	}
      Stop();
    }
  return;
}



void oledmain(void)
{
  
  //IE=0x81;
  //IP=0x01;
  //TCON=0x01;
  //int0=1;
  
  Delay(100);

  initialise_oled();
  Delay(1000);
  while(1)
    {
#if 0      
      Display_Picture(pic);
      sleep_ms(DEMO_DELAY);
 
      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa7);//--set Inverse Display 
      SentByte(0x00);
      Stop();
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa6);//--set normal display
      SentByte(0x00);
      Stop();
      Display_Picture(pic1);
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa7);//--set Inverse Display 
      SentByte(0x00);
      Stop();
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa6);//--set normal display
      SentByte(0x00);
      Stop();
      Display_Picture(pic2);
      sleep_ms(DEMO_DELAY);
      
      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa7);//--set Inverse Display 
      SentByte(0x00);
      Stop();
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa6);//--set normal display
      SentByte(0x00);
      Stop();
      Display_Picture(pic3);
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa7);//--set Inverse Display 
      SentByte(0x00);
      Stop();
      sleep_ms(DEMO_DELAY);
#endif

#if 0      
      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa6);//--set normal display
      SentByte(0x00);
      Stop();
      Display_Chess(0x0f);
      sleep_ms(DEMO_DELAY);
#endif
      int i = 0;
      for(int y=0; y<4;  y++)
	{
	  for(int x=0; x<20; x++)
	    {
	      printxy(x, y, ' '+(i++));
	      i = (i % 64);
	    }
	}
	    
#if 0      
      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa7);//--set Inverse Display 
      SentByte(0x00);
      
      Stop();
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa6);//--set normal display
      SentByte(0x00);
      Stop();
      Display_Chinese(font);
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa7);//--set Inverse Display 
      SentByte(0x00);
      Stop(); 
      Display_Chinese(font);
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa6);//--set normal display
      SentByte(0x00);
      Stop();
      Display_Chinese_Column(font);
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa7);//--set Inverse Display 
      SentByte(0x00);
      Stop(); 
      Display_Chinese_Column(font);
      sleep_ms(DEMO_DELAY);

      Start();
      SentByte(Write_Address);
      SentByte(0x80);
      SentByte(0xa6);//--set normal display
      SentByte(0x00);
      Stop();
      sleep_ms(DEMO_DELAY);
#endif
    }
}


